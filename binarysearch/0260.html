<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>BinarySearch 0260 Best Interval to Remove | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="BinarySearch 0260 Best Interval to Remove" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Problem statement" />
<meta property="og:description" content="Problem statement" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-01T22:51:09+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="BinarySearch 0260 Best Interval to Remove" />
<script type="application/ld+json">
{"url":"/binarysearch/0260.html","@type":"BlogPosting","headline":"BinarySearch 0260 Best Interval to Remove","dateModified":"2022-02-01T22:51:09+03:00","datePublished":"2022-02-01T22:51:09+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"/binarysearch/0260.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Problem statement","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/codeforces%20problems/">Codeforces</a><a class="page-link" href="/leetcode%20problems/">Leetcode</a><a class="page-link" href="/binarysearch%20problems/">BinarySearch</a><a class="page-link" href="/coding%20ideas/">Patterns</a><a class="page-link" href="/performance%20tricks/">Speed up</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/intervals"><code class="highligher-rouge"><nobr>intervals</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/accumulate"><code class="highligher-rouge"><nobr>accumulate</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/sort"><code class="highligher-rouge"><nobr>sort</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">BinarySearch 0260 Best Interval to Remove</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-02-01T22:51:09+03:00" itemprop="datePublished">
        Feb 1, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-statement">Problem statement</h4>

<p><a href="https://binarysearch.com/problems/Best-Interval-to-Remove/"> <font color="blue">https://binarysearch.com/problems/Best-Interval-to-Remove/</font></a></p>

<h4 id="solution">Solution</h4>
<ol>
  <li>First of all, there is a trick, how I handle with empty segments <code class="language-plaintext highlighter-rouge">[x, x]</code>. We extend each segment <code class="language-plaintext highlighter-rouge">0.25</code> to the left and to the right and then multiply by <code class="language-plaintext highlighter-rouge">4</code>. In this way we never have empty segments and also the answer will not change: if segments were separate in original date, they still be separate in new data.</li>
  <li>Second trick I use is coordinate compression. We look at segment <code class="language-plaintext highlighter-rouge">[1, 5]</code> as segment which cover segments <code class="language-plaintext highlighter-rouge">[1, 2] + [2, 3] + [3, 4] + [4, 5]</code>. Also we put as our coordinates not only ends of segment <code class="language-plaintext highlighter-rouge">[x, y-1]</code>, but also <code class="language-plaintext highlighter-rouge">x-1</code>, we will see a bit later why.</li>
</ol>

<p>Let us consider the case <code class="language-plaintext highlighter-rouge">intervals = [[2, 5], [3, 4], [4, 7], [6, 8]]</code>. Then we have:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">intervals = [(7, 21), (11, 17), (15, 29), (23, 33)]</code></li>
  <li><code class="language-plaintext highlighter-rouge">d = {7: 0, 11: 1, 15: 2, 17: 3, 21: 4, 23: 5, 29: 6, 33: 7}</code>. What we keep in <code class="language-plaintext highlighter-rouge">d</code> are compressed coordinates.</li>
  <li><code class="language-plaintext highlighter-rouge">acc = [1, 2, 3, 2, 1, 2, 1]</code>. What we keep in <code class="language-plaintext highlighter-rouge">acc</code> is coverage for each segment <code class="language-plaintext highlighter-rouge">[0, 1], [1, 2], ...</code>: how many times it is covered: that is first part is covered once, second also once, than twice and so on.</li>
  <li><code class="language-plaintext highlighter-rouge">arr = [1, 0, 0, 0, 1, 0, 1]</code> in this array we keep only elements from <code class="language-plaintext highlighter-rouge">acc</code> which are not one. We need this, because we only interested in ones: when we remove them, coverege will be zero and number of parst can increase.</li>
  <li><code class="language-plaintext highlighter-rouge">arr2 = [1, 2, 2, 2, 3, 4, 5]</code>. Here we calculate special cumulative sum of <code class="language-plaintext highlighter-rouge">arr</code>: what we keep here is when we go from <code class="language-plaintext highlighter-rouge">1</code> to <code class="language-plaintext highlighter-rouge">0</code> or from <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">1</code>, we increase sum. It will help us to underatand how many parts we will have. Imagine the case when we have part <code class="language-plaintext highlighter-rouge">[1, </code><strong>1, 2, 2, 2, 2, 2, 3</strong>, <code class="language-plaintext highlighter-rouge">4, 4, 5]</code>, then how many parts there will be? There will be one more gap in the left, because <code class="language-plaintext highlighter-rouge">1</code> becomes equal to <code class="language-plaintext highlighter-rouge">0</code>. Also there will be one gap in the right, because <code class="language-plaintext highlighter-rouge">new_acc = [1, 0, 1, 1, 2, 2, 1, 0, 2, 2, 1]</code>. Number of gaps can be calculated, using parity of begin and end: if both of them are odd, it means, that ends of our segments will create gaps as well all group of ones in the middle. If we have both ends even, it means, that we have only gaps between. If one is odd and another is even, it will give one gap. However there can be cases, when gap is not created in the end. Imagine the case <code class="language-plaintext highlighter-rouge">acc = [1, 1, 2, 2, 1, 0, 1, 1]</code>. Then if we consider elements from <code class="language-plaintext highlighter-rouge">0th to </code>4<code class="language-plaintext highlighter-rouge">, we will have </code>acc_new = [0, 0, 1, 1, 0, 0, 1, 1]`. What happened here is that in fact on the left gap is not created, because it is the end of array. On the right gap is not created, because there were already gap there. So for each interval we check these conditions and update number of gaps.</li>
</ol>

<p>Finally, what we do is calculate number of gaps when we take all segments: we look at <code class="language-plaintext highlighter-rouge">acc</code> and find how many places we have when we change from <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">not 0</code> or from <code class="language-plaintext highlighter-rouge">not 0</code> to <code class="language-plaintext highlighter-rouge">0</code>.</p>

<h4 id="complexity">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n log n)</code> for time and <code class="language-plaintext highlighter-rouge">O(n)</code> for space.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intervals</span><span class="p">):</span>
        <span class="n">intervals</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">]</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">|=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">)))}</span>

        <span class="n">diffs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">:</span>
            <span class="n">diffs</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">diffs</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]]</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="n">acc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">accumulate</span><span class="p">(</span><span class="n">diffs</span><span class="p">))[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">acc</span><span class="p">]</span>
        <span class="n">arr2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">accumulate</span><span class="p">((</span><span class="n">x</span><span class="o">!=</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">arr</span><span class="p">,</span> <span class="n">arr</span><span class="p">))))</span>

        <span class="n">ans</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">:</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">beg</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">arr2</span><span class="p">[</span><span class="n">A</span><span class="p">],</span> <span class="n">arr2</span><span class="p">[</span><span class="n">B</span><span class="p">]</span>
            <span class="n">cand</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">beg</span> <span class="o">+</span> <span class="n">beg</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">end</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>

            <span class="k">if</span> <span class="n">acc</span><span class="p">[</span><span class="n">A</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">A</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">acc</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">cand</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">acc</span><span class="p">[</span><span class="n">B</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">B</span> <span class="o">==</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">acc</span><span class="p">[</span><span class="n">B</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">cand</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="n">ans</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">cand</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ans</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">acc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span><span class="o">//</span><span class="mi">2</span>
</code></pre></div></div>

  </div><a class="u-url" href="/binarysearch/0260.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>