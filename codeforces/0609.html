<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Codeforces contest 0609 | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Codeforces contest 0609" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems." />
<meta property="og:description" content="Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems." />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Codeforces contest 0609" />
<script type="application/ld+json">
{"url":"/codeforces/0609.html","@type":"WebPage","headline":"Codeforces contest 0609","author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/codeforces%20problems/">Codeforces</a><a class="page-link" href="/leetcode%20problems/">Leetcode</a><a class="page-link" href="/binarysearch%20problems/">BinarySearch</a><a class="page-link" href="/coding%20ideas/">Patterns</a><a class="page-link" href="/performance%20tricks/">Speed up</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/greedy"><code class="highligher-rouge"><nobr>greedy</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/sort"><code class="highligher-rouge"><nobr>sort</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/math"><code class="highligher-rouge"><nobr>math</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/combinatorics"><code class="highligher-rouge"><nobr>combinatorics</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/binary search"><code class="highligher-rouge"><nobr>binary search</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/merge sort"><code class="highligher-rouge"><nobr>merge sort</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/LCA"><code class="highligher-rouge"><nobr>LCA</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/spanning tree"><code class="highligher-rouge"><nobr>spanning tree</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/dsu"><code class="highligher-rouge"><nobr>dsu</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/binary lifting"><code class="highligher-rouge"><nobr>binary lifting</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/segment tree"><code class="highligher-rouge"><nobr>segment tree</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Codeforces contest 0609</h1>
    <p class="post-meta"><time class="dt-published" datetime="" itemprop="datePublished">
        
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-a-statement">Problem A statement</h4>
<p>[greedy, sort]</p>

<p><a href="https://codeforces.com/contest/609/problem/A"> <font color="blue">https://codeforces.com/contest/609/problem/A</font></a></p>

<h4 id="solution">Solution</h4>
<p>Just use the biggest cards.</p>

<h4 id="complexity">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n log n)</code> for time and <code class="language-plaintext highlighter-rouge">O(n)</code> for space.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
<span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
<span class="n">arr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">arr</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())]</span>

<span class="n">arr</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">arr</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">acc</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">acc</span> <span class="o">+=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">acc</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">break</span>
</code></pre></div></div>

<h4 id="problem-b-statement">Problem B statement</h4>
<p>[math, combinatorics]</p>

<p><a href="https://codeforces.com/contest/609/problem/B"> <font color="blue">https://codeforces.com/contest/609/problem/B</font></a></p>

<h4 id="solution-1">Solution</h4>
<p>Evaluate number of all options and then subtract number of optinos which violates condition.</p>

<h4 id="complexity-1">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n)</code> for time and space.</p>

<h4 id="code-1">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>
<span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">cnt</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="n">ans</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cnt</span><span class="p">:</span>
    <span class="n">ans</span> <span class="o">-=</span> <span class="n">cnt</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>

<span class="k">print</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="problem-c-statement">Problem C statement</h4>
<p>[sort, greedy]</p>

<p><a href="https://codeforces.com/contest/609/problem/C"> <font color="blue">https://codeforces.com/contest/609/problem/C</font></a></p>

<h4 id="solution-2">Solution</h4>
<p>First of all, we can understand what is the final position of our servers: we need to put <code class="language-plaintext highlighter-rouge">sm//n</code> to all of them and then add <code class="language-plaintext highlighter-rouge">1</code> to sm%n<code class="language-plaintext highlighter-rouge"> of them. Let us sort start and final position, then answer will be sum of absolute differences of elements divided by </code>2`. Why though it is a good mathematical problem.</p>

<h4 id="complexity-2">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n log n)</code> for time and <code class="language-plaintext highlighter-rouge">O(n)</code> for space.</p>

<h4 id="code-2">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
<span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>

<span class="n">arr</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">arr</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">sm</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="n">final</span> <span class="o">=</span> <span class="p">[</span><span class="n">sm</span><span class="o">//</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sm</span> <span class="o">%</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">final</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">ans</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">final</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ans</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="problem-d-statement">Problem D statement</h4>
<p>[binary search, merge sort]</p>

<p><a href="https://codeforces.com/contest/609/problem/D"> <font color="blue">https://codeforces.com/contest/609/problem/D</font></a></p>

<h4 id="solution-3">Solution</h4>
<p>The idea is to ask question: given that we can use only first <code class="language-plaintext highlighter-rouge">x</code> days, can we buy <code class="language-plaintext highlighter-rouge">k</code> items. To answer this question we need to find the lowerst cost of dollar and pound in the first <code class="language-plaintext highlighter-rouge">x</code> days. Now, using this costs, we have two sorted array of prices for two types of items (if we sort them once in the beginning), we can merget sort them and choose the smallest <code class="language-plaintext highlighter-rouge">k</code>. Then we use binary search to answer the question what is the minimum number of days we need. One short optimization is to use cumulative minimums to fast access for min costs of dollar and pound.</p>

<h4 id="complexity-3">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n log n)</code> for time and <code class="language-plaintext highlighter-rouge">O(n)</code> for space. It can be made to <code class="language-plaintext highlighter-rouge">O(k log n)</code> in fact.</p>

<h4 id="code-3">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">accumulate</span>
<span class="kn">import</span> <span class="nn">io</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">sys</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">os</span><span class="p">.</span><span class="n">fstat</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">st_size</span><span class="p">)).</span><span class="n">readline</span>
<span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>

<span class="n">C1</span><span class="p">,</span> <span class="n">C2</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">C1</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">C2</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span>

<span class="n">C1</span><span class="p">,</span> <span class="n">C2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">C1</span><span class="p">),</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span>
<span class="n">A_acc</span><span class="p">,</span> <span class="n">B_acc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">accumulate</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">min</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="n">accumulate</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="nb">min</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>   <span class="c1"># price to buy in first x days
</span>    <span class="n">min_C1</span> <span class="o">=</span> <span class="n">A_acc</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">min_C2</span> <span class="o">=</span> <span class="n">B_acc</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">prices</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">min_C1</span> <span class="o">*</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">C1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">min_C2</span> <span class="o">*</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">C2</span><span class="p">])</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prices</span><span class="p">[:</span><span class="n">k</span><span class="p">])</span>

<span class="k">if</span> <span class="n">check</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">s</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">beg</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span>
    <span class="k">while</span> <span class="n">beg</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">beg</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
        <span class="n">price</span> <span class="o">=</span> <span class="n">check</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">price</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">mid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">beg</span> <span class="o">=</span> <span class="n">mid</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">beg</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">min_C1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">A</span><span class="p">[:</span><span class="n">x</span><span class="p">])</span>
    <span class="n">min_C2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">B</span><span class="p">[:</span><span class="n">x</span><span class="p">])</span>
    <span class="n">day</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">[:</span><span class="n">x</span><span class="p">].</span><span class="n">index</span><span class="p">(</span><span class="n">min_C1</span><span class="p">),</span> <span class="n">B</span><span class="p">[:</span><span class="n">x</span><span class="p">].</span><span class="n">index</span><span class="p">(</span><span class="n">min_C2</span><span class="p">)]</span>
    <span class="n">prices</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([(</span><span class="n">min_C1</span> <span class="o">*</span> <span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">C1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[(</span><span class="n">min_C2</span> <span class="o">*</span> <span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">C2</span><span class="p">])</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">day</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">prices</span><span class="p">[:</span><span class="n">k</span><span class="p">]]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">ans</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>

<h4 id="problem-e-statement">Problem E statement</h4>
<p>[LCA, spanning tree, dsu, binary lifting]</p>

<p><a href="https://codeforces.com/contest/609/problem/E"> <font color="blue">https://codeforces.com/contest/609/problem/E</font></a></p>

<h4 id="solution-4">Solution</h4>
<p>This is the author’s solution of this problem, but unfortunately it gives TLE in python, and I spend some time trying to optimize it. However it is useful template for future, so here it is.</p>

<p>Let us construct MST of our graph, using for example Kruskal algorithm (I tried Prim as well, but still TLE). Then if node in our MST, we alredy know the answer. If it is not, we need to find loop if we add this edge to MST. For this we find LCA <code class="language-plaintext highlighter-rouge">uv</code> of nodes <code class="language-plaintext highlighter-rouge">u</code> and <code class="language-plaintext highlighter-rouge">v</code> and our loop is now <code class="language-plaintext highlighter-rouge">u---uv---v-u</code>. We need to find maximum weigth in this loop, for this we can use binary lifting. See leetcode 1724 problem for more details.</p>

<h4 id="complexity-4">Complexity</h4>
<p>Time comlexity is <code class="language-plaintext highlighter-rouge">O(E log n)</code>.</p>

<h4 id="code-4">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">deque</span>
<span class="kn">import</span> <span class="nn">io</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">sys</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="n">fstat</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">st_size</span><span class="p">)).</span><span class="n">readline</span>
<span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>

<span class="k">def</span> <span class="nf">kruskal</span><span class="p">(</span><span class="n">E</span><span class="p">):</span>
    <span class="n">total_w</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">E</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dsu</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">==</span> <span class="n">dsu</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">):</span> <span class="k">continue</span>
        <span class="n">dsu</span><span class="p">.</span><span class="n">union</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">MST</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">append</span><span class="p">((</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
        <span class="n">MST</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">append</span><span class="p">((</span><span class="n">u</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
        <span class="n">total_w</span> <span class="o">+=</span> <span class="n">w</span>
    <span class="k">return</span> <span class="n">total_w</span>


<span class="k">def</span> <span class="nf">LCA</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depths</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">depths</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">,</span> <span class="n">u</span>

    <span class="n">diff</span> <span class="o">=</span> <span class="n">depths</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">-</span> <span class="n">depths</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>

    <span class="n">weight</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">places</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">diff</span><span class="p">.</span><span class="n">bit_length</span><span class="p">())</span> <span class="k">if</span> <span class="n">diff</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">places</span><span class="p">:</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">max_path</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">index</span><span class="p">])</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">parents</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span> <span class="k">return</span> <span class="n">weight</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bits</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">parents</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">parents</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">weight</span><span class="p">,</span> <span class="n">max_path</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">max_path</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">parents</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">parents</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">weight</span><span class="p">,</span> <span class="n">max_path</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">max_path</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>

<span class="k">class</span> <span class="nc">DSU</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">acopy</span> <span class="o">=</span> <span class="n">a</span>
        <span class="k">while</span> <span class="n">a</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">.</span><span class="n">parent</span><span class="p">[</span><span class="n">a</span><span class="p">]:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">parent</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">acopy</span> <span class="o">!=</span> <span class="n">a</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">parent</span><span class="p">[</span><span class="n">acopy</span><span class="p">],</span> <span class="n">acopy</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">parent</span><span class="p">[</span><span class="n">acopy</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">a</span>

    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">parent</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">b</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">E</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">d_E</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
    <span class="n">E</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="p">)]</span>
    <span class="n">d_E</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

<span class="n">dsu</span> <span class="o">=</span> <span class="n">DSU</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">depths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
<span class="n">bits</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="n">bit_length</span><span class="p">()</span>
<span class="n">parents</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">bits</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">max_path</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">bits</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">E</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">visited</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
<span class="n">MST</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="n">total_w</span> <span class="o">=</span> <span class="n">kruskal</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>


<span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="n">depths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">parents</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">q</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">popleft</span><span class="p">()</span>
    <span class="n">di</span> <span class="o">=</span> <span class="n">depths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">MST</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">depths</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">q</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">depths</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">di</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">parents</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">max_path</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">parents</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">parents</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">parents</span><span class="p">[</span><span class="n">pp</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">max_path</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_path</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">max_path</span><span class="p">[</span><span class="n">pp</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">d_E</span><span class="p">:</span>
    <span class="n">max_w</span> <span class="o">=</span> <span class="n">LCA</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ans</span><span class="p">[</span><span class="n">d_E</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">]]</span> <span class="o">=</span> <span class="n">total_w</span> <span class="o">-</span> <span class="n">max_w</span> <span class="o">+</span> <span class="n">w</span>

<span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">" "</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">ans</span><span class="p">))</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="problem-f-statement">Problem F statement</h4>
<p>[segment tree, sort]</p>

<p><a href="https://codeforces.com/contest/609/problem/F"> <font color="blue">https://codeforces.com/contest/609/problem/F</font></a></p>

<h4 id="solution-5">Solution</h4>
<p>Unfortunately there is no way to get AC in python. I invented solution using two segment trees. In the first one we keep values for each coordinate, which frog is covering this coordinate.
For example if we have frogs <code class="language-plaintext highlighter-rouge">[0, 3]</code> and <code class="language-plaintext highlighter-rouge">[2, 4]</code>, then we have <code class="language-plaintext highlighter-rouge">[0, 0, 0, 0, 1, 1, 1, inf, inf, ...]</code>. We can notice that we can use segment tree with functionality:</p>
<ol>
  <li>For all elements in range <code class="language-plaintext highlighter-rouge">[r, l)</code> apply <code class="language-plaintext highlighter-rouge">ai = min(ai, v)</code>.</li>
  <li>Find element at index <code class="language-plaintext highlighter-rouge">i</code>.</li>
</ol>

<p>Then when frog eat some mosquito, we need to update range which it covers.
Also we need to keep the set of mosquitos, which were not eaten yet. We can keep them in sorted list for example. However we can use another segment tree, where we keep in element <code class="language-plaintext highlighter-rouge">x</code> weight of all mosquitos which we have in this index (there can be more than one). More detailed we will keep <code class="language-plaintext highlighter-rouge">w1 + ... + wk + k</code> value, because there can be zero mosquitos and it is matter how much of them we have.
For this tree we need to perform the following operations:</p>
<ol>
  <li>Set element <code class="language-plaintext highlighter-rouge">i</code> equal to <code class="language-plaintext highlighter-rouge">v</code>.</li>
  <li>Find first index of element starting from index <code class="language-plaintext highlighter-rouge">l</code>, such that it is <code class="language-plaintext highlighter-rouge">&gt;= x</code>.</li>
</ol>

<p>No, we do the following when we have new element <code class="language-plaintext highlighter-rouge">(p, b)</code>.</p>
<ol>
  <li>If we have element in index <code class="language-plaintext highlighter-rouge">p</code> in first tree equal to <code class="language-plaintext highlighter-rouge">+inf</code>, it means that no frog can eat it. In this case we update <code class="language-plaintext highlighter-rouge">place_mosquito[p]</code> and also update element in <code class="language-plaintext highlighter-rouge">STree2</code>.</li>
  <li>In the opposite case it means that some frog can eat this mosquito. We can find it as <code class="language-plaintext highlighter-rouge">STree1.get(p)</code>. First, we modify range for our frog, that is extend it <code class="language-plaintext highlighter-rouge">b</code> values to the right. Also we update <code class="language-plaintext highlighter-rouge">T[frog]</code>: its tongue length and <code class="language-plaintext highlighter-rouge">eaten[frog] += 1</code>.
Then we need to eat all mosquitos in new range if we have. First, we find the index of non-zero element in <code class="language-plaintext highlighter-rouge">STree2</code>. If this place is <code class="language-plaintext highlighter-rouge">-1</code> or more than tongue length, we break. Also we find <code class="language-plaintext highlighter-rouge">b2</code> is total weight of mosqitoes in this place. Then we modify responsibility of given frog, update <code class="language-plaintext highlighter-rouge">T[frog]</code>: tongue length, update <code class="language-plaintext highlighter-rouge">eaten[frog]</code> and finally set number of mosquitos in given place to zero and also place <code class="language-plaintext highlighter-rouge">STree[place]</code> equal to zero.</li>
</ol>

<p>Here I used fact, that value of element with index <code class="language-plaintext highlighter-rouge">place</code> is <code class="language-plaintext highlighter-rouge">STree2.T[place + N1]</code>, where <code class="language-plaintext highlighter-rouge">N1</code> is the smallest power of two minus one, such that it is bigger than <code class="language-plaintext highlighter-rouge">N</code>.</p>

<h4 id="complexity-5">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O((n + m) log N)</code>, where <code class="language-plaintext highlighter-rouge">N = 10^9</code> is the size of sparse segment tree.</p>

<h4 id="code-5">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">Counter</span>
<span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>

<span class="c1"># 1. For all elements in range [r, l) apply ai = min(ai, v)
# 2. Find element at index i
</span><span class="k">class</span> <span class="nc">SegmentTree1</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="bp">self</span><span class="p">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">size</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="s">"inf"</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_modify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lx</span><span class="p">,</span> <span class="n">rx</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;=</span> <span class="n">rx</span> <span class="ow">or</span> <span class="n">lx</span> <span class="o">&gt;=</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">lx</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="ow">and</span> <span class="n">rx</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">mx</span> <span class="o">=</span> <span class="p">(</span><span class="n">lx</span> <span class="o">+</span> <span class="n">rx</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_modify</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">lx</span><span class="p">,</span> <span class="n">mx</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_modify</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">rx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">modify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_modify</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lx</span><span class="p">,</span> <span class="n">rx</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">rx</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">mx</span> <span class="o">=</span> <span class="p">(</span><span class="n">lx</span> <span class="o">+</span> <span class="n">rx</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mx</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lx</span><span class="p">,</span> <span class="n">mx</span><span class="p">),</span> <span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">rx</span><span class="p">),</span> <span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>


<span class="c1"># 1. Set element i equal to v.
# 2. First index element in tree starting from index l, which is &gt;= x.
</span><span class="k">class</span> <span class="nc">SegmentTree2</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="bp">self</span><span class="p">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">size</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lx</span><span class="p">,</span> <span class="n">rx</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">rx</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">return</span>
        <span class="n">mx</span> <span class="o">=</span> <span class="p">(</span><span class="n">lx</span> <span class="o">+</span> <span class="n">rx</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mx</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_set</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lx</span><span class="p">,</span> <span class="n">mx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_set</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">rx</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_set</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">first_above_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lx</span><span class="p">,</span> <span class="n">rx</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">v</span> <span class="ow">or</span> <span class="n">rx</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">rx</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">lx</span>
        <span class="n">mx</span> <span class="o">=</span> <span class="p">(</span><span class="n">lx</span> <span class="o">+</span> <span class="n">rx</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">first_above_</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lx</span><span class="p">,</span> <span class="n">mx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">first_above_</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">rx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">first_above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">first_above_</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">XTi</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">eaten</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
    <span class="n">XTi</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span>

<span class="n">XTi</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">XTi</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">XTi</span><span class="p">]</span>
<span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">XTi</span><span class="p">]</span>
<span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">XTi</span><span class="p">]</span>

<span class="n">N</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
<span class="n">N1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">N</span><span class="p">.</span><span class="n">bit_length</span><span class="p">()))</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">STree1</span> <span class="o">=</span> <span class="n">SegmentTree1</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">STree2</span> <span class="o">=</span> <span class="n">SegmentTree2</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="n">STree1</span><span class="p">.</span><span class="n">modify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

<span class="n">place_mosquito</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
    <span class="n">frog</span> <span class="o">=</span> <span class="n">STree1</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">frog</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s">"inf"</span><span class="p">):</span>  <span class="c1"># means mosquito can not be eaten
</span>        <span class="n">place_mosquito</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">STree2</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">STree2</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="n">p</span> <span class="o">+</span> <span class="n">N1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">STree1</span><span class="p">.</span><span class="n">modify</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">frog</span><span class="p">)</span>
        <span class="n">T</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+=</span> <span class="n">b</span>
        <span class="n">eaten</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">place</span> <span class="o">=</span> <span class="n">STree2</span><span class="p">.</span><span class="n">first_above</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">frog</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">place</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">place</span> <span class="o">&gt;</span> <span class="n">X</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="n">frog</span><span class="p">]:</span> <span class="k">break</span>
            <span class="n">b2</span> <span class="o">=</span> <span class="n">STree2</span><span class="p">.</span><span class="n">T</span><span class="p">[</span><span class="n">place</span> <span class="o">+</span> <span class="n">N1</span><span class="p">]</span> <span class="o">-</span> <span class="n">place_mosquito</span><span class="p">[</span><span class="n">place</span><span class="p">]</span>
            <span class="n">STree1</span><span class="p">.</span><span class="n">modify</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">frog</span><span class="p">)</span>
            <span class="n">T</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+=</span> <span class="n">b2</span>
            <span class="n">eaten</span><span class="p">[</span><span class="n">frog</span><span class="p">]</span> <span class="o">+=</span> <span class="n">place_mosquito</span><span class="p">[</span><span class="n">place</span><span class="p">]</span>
            <span class="n">place_mosquito</span><span class="p">[</span><span class="n">place</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">STree2</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">place</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">ans</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">eaten</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ans</span><span class="p">:</span>
    <span class="n">gap</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</code></pre></div></div>

<h4 id="remark">Remark</h4>
<p>I am wondering if this code will get AC in C++, it seems complexities are good enough here.</p>

  </div><a class="u-url" href="/codeforces/0609.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>