<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Codeforces contest 0616 | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Codeforces contest 0616" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here you can find solution and patterns for algorithmic questions: leetcode, binarysearch, codeforces, cses and probably more later." />
<meta property="og:description" content="Here you can find solution and patterns for algorithmic questions: leetcode, binarysearch, codeforces, cses and probably more later." />
<link rel="canonical" href="http://localhost:4000/codeforces/0616.html" />
<meta property="og:url" content="http://localhost:4000/codeforces/0616.html" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Codeforces contest 0616" />
<script type="application/ld+json">
{"url":"http://localhost:4000/codeforces/0616.html","author":{"@type":"Person","name":"Dmitry Babichev"},"@type":"WebPage","description":"Here you can find solution and patterns for algorithmic questions: leetcode, binarysearch, codeforces, cses and probably more later.","headline":"Codeforces contest 0616","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Dmitry Babichev&apos;s webpage" />
    






  



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/patreon/">Patreon</a><a class="page-link" href="/codeforces%20problems/">Codeforces</a><a class="page-link" href="/leetcode/">Leetcode</a><a class="page-link" href="/binarysearch%20problems/">BinarySearch</a><a class="page-link" href="/CSES%20problems/">CSES</a><a class="page-link" href="/coding%20ideas/">Patterns</a><a class="page-link" href="/performance%20tricks/">Speed up</a><a class="page-link" href="/contests%20problems/">Contests</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/string"><code class="highligher-rouge"><nobr>string</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/2d-array"><code class="highligher-rouge"><nobr>2d-array</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/dfs"><code class="highligher-rouge"><nobr>dfs</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/bfs"><code class="highligher-rouge"><nobr>bfs</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/connected components"><code class="highligher-rouge"><nobr>connected components</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/sliding window"><code class="highligher-rouge"><nobr>sliding window</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/two pointers"><code class="highligher-rouge"><nobr>two pointers</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/sqrt decomposition"><code class="highligher-rouge"><nobr>sqrt decomposition</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/math"><code class="highligher-rouge"><nobr>math</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/suffix array"><code class="highligher-rouge"><nobr>suffix array</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/bst"><code class="highligher-rouge"><nobr>bst</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/intervals"><code class="highligher-rouge"><nobr>intervals</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/union find"><code class="highligher-rouge"><nobr>union find</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/graph"><code class="highligher-rouge"><nobr>graph</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Codeforces contest 0616</h1>
    <p class="post-meta"><time class="dt-published" datetime="" itemprop="datePublished">
        
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-a-statement">Problem A statement</h4>
<p>[string]</p>

<p><a href="https://codeforces.com/contest/616/problem/A"> <font color="blue">https://codeforces.com/contest/616/problem/A</font></a></p>

<h4 id="solution">Solution</h4>
<p>Just compare symbol by symbol.</p>

<h4 id="complexity">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n + m)</code> for time and space.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">readline</span>

<span class="n">a</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">*</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">b</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">*</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>

<span class="n">equal</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"&lt;"</span><span class="p">)</span>
        <span class="n">equal</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">break</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"&gt;"</span><span class="p">)</span>
        <span class="n">equal</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">break</span>

<span class="k">if</span> <span class="n">equal</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">"="</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="problem-b-statement">Problem B statement</h4>
<p>[2d-array]</p>

<p><a href="https://codeforces.com/contest/616/problem/B"> <font color="blue">https://codeforces.com/contest/616/problem/B</font></a></p>

<h4 id="solution-1">Solution</h4>
<p>We need fo find minimax in this problem.</p>

<h4 id="complexity-1">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(nm)</code> for time and <code class="language-plaintext highlighter-rouge">O(m)</code> for space.</p>

<h4 id="code-1">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>

<span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="problem-c-statement">Problem C statement</h4>
<p>[dfs, bfs, graph, connected components]</p>

<p><a href="https://codeforces.com/contest/616/problem/C"> <font color="blue">https://codeforces.com/contest/616/problem/C</font></a></p>

<h4 id="solution-2">Solution</h4>
<p>Nothing difficult here, but in python it is difficult to avoid TLE.</p>
<ol>
  <li>We need to traverse our grid with dfs with stack and find connected components. For faster access we create <code class="language-plaintext highlighter-rouge">vis = [-1] * (n * m)</code> list. Then we start traversing from every empty sell. In <code class="language-plaintext highlighter-rouge">vis</code> we will have the number of connected component. In <code class="language-plaintext highlighter-rouge">cnt[i]</code> we will keep size of connected component <code class="language-plaintext highlighter-rouge">i</code>.</li>
  <li>After we traverse, do one more traverse, where for every <code class="language-plaintext highlighter-rouge">*</code> element we look at four neighbours and create set of connected components that can be reached from it. Then we sum all sizes of these components.</li>
</ol>

<h4 id="complexity-2">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(mn)</code> for time and space.</p>

<h4 id="code-2">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">readline</span>

<span class="n">valid</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="ow">and</span> <span class="n">grid</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="s">'.'</span>
<span class="n">dr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>
<span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">vis</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">cur</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">m</span><span class="p">),</span> <span class="p">[],</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s">'.'</span> <span class="ow">and</span> <span class="n">vis</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">stk</span><span class="p">,</span> <span class="n">vis</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)],</span> <span class="n">cur</span>
            <span class="n">cnt</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">while</span> <span class="n">stk</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">stk</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                    <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dr</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dr</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">valid</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span> <span class="ow">and</span> <span class="n">vis</span><span class="p">[</span><span class="n">nx</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">ny</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">stk</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">))</span>
                        <span class="n">vis</span><span class="p">[</span><span class="n">nx</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">ny</span><span class="p">]</span> <span class="o">=</span> <span class="n">cur</span>
                        <span class="n">cnt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">cur</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">tem</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s">'.'</span><span class="p">:</span>
            <span class="n">tem</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dis</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">dr</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">j</span> <span class="o">+</span> <span class="n">dr</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">valid</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span> <span class="ow">and</span> <span class="n">vis</span><span class="p">[</span><span class="n">nx</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">ny</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">dis</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">nx</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">ny</span><span class="p">])</span>

            <span class="n">tem</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="nb">sum</span><span class="p">([</span><span class="n">cnt</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dis</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">tem</span><span class="p">))</span>

</code></pre></div></div>

<h4 id="problem-d-statement">Problem D statement</h4>
<p>[sliding window, two pointers]</p>

<p><a href="https://codeforces.com/contest/616/problem/D"> <font color="blue">https://codeforces.com/contest/616/problem/D</font></a></p>

<h4 id="solution-3">Solution</h4>
<p>Equal to Leetcode 0340, just use sliding window here.</p>

<h4 id="complexity-3">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n)</code> for time and space.</p>

<h4 id="code-3">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>
<span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="n">window</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
<span class="n">beg</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="mi">0</span>
<span class="n">ans</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">while</span> <span class="n">beg</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dist</span> <span class="o">==</span> <span class="n">k</span> <span class="ow">and</span> <span class="n">window</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">end</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">dist</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span> <span class="n">window</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">end</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">window</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">end</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">dist</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">end</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">beg</span><span class="p">,</span> <span class="n">beg</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">window</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">beg</span><span class="p">]]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">window</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">beg</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">dist</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">beg</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ans</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<h4 id="problem-e-statement">Problem E statement</h4>
<p>[sqrt decomposition, math]</p>

<p><a href="https://codeforces.com/contest/616/problem/E"> <font color="blue">https://codeforces.com/contest/616/problem/E</font></a></p>

<h4 id="solution-4">Solution</h4>
<p>Let us look for the case <code class="language-plaintext highlighter-rouge">n = 1000</code>. Then if we look at <code class="language-plaintext highlighter-rouge">n//1, n//2, n//3, ..., n//n</code> then we can group elements starging from <code class="language-plaintext highlighter-rouge">sqrt(n)</code> with groups with equal values. If in some group <code class="language-plaintext highlighter-rouge">n//x, ... n//y</code> all elements are equal, then we can calculate <code class="language-plaintext highlighter-rouge">n%x + ... + n%y</code> in <code class="language-plaintext highlighter-rouge">O(1)</code> time. So, we use sqrt decomposition, where we evaluate <code class="language-plaintext highlighter-rouge">n%1, n%2, ... n%x</code>, wheren <code class="language-plaintext highlighter-rouge">x = int(sqrt(n))</code> and then evaluate sum in each group. We need to be careful with some edge cases.</p>

<h4 id="complexity-4">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(sqrt(n))</code> for time and space.</p>

<h4 id="code-4">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
 
<span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>
<span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="k">if</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
    <span class="n">ans</span> <span class="o">+=</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">n</span>
<span class="n">n2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
 
<span class="n">ans</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
 
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">m</span><span class="p">:</span> <span class="k">break</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">ans</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="n">y</span><span class="p">)</span>
 
<span class="k">print</span><span class="p">(</span><span class="n">ans</span> <span class="o">%</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">))</span>
</code></pre></div></div>

<h4 id="problem-f-statement">Problem F statement</h4>
<p>[string, suffix array, bst, intervals, union find, graph]</p>

<p><a href="https://codeforces.com/contest/616/problem/F"> <font color="blue">https://codeforces.com/contest/616/problem/F</font></a></p>

<h4 id="solution-5">Solution</h4>
<p>If you see problem about substring, there is a probability that it can be solved with suffix array or suffix tree.
Let us concatenate all strings, adding different separators after each string. Then let us create suffix array as well as LCP for this string. We can do it in <code class="language-plaintext highlighter-rouge">O(n)</code>, using template. Also we need to create the list of the same length <code class="language-plaintext highlighter-rouge">B</code>, which for each element of string have cost of this string. No, let us have an example <code class="language-plaintext highlighter-rouge">0, 1, 2, 3, 3, 1, 3, 2, 3</code> of LCP and think what we can do with it. Imagine also that <code class="language-plaintext highlighter-rouge">B = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code>. Notice that in <code class="language-plaintext highlighter-rouge">B</code> we have one more element, because <code class="language-plaintext highlighter-rouge">LCP</code> elements correspond to gaps between <code class="language-plaintext highlighter-rouge">B</code> elements. We need to take some substring of this sequence, for example <code class="language-plaintext highlighter-rouge">3, 2, 3</code>, which can correspond to <code class="language-plaintext highlighter-rouge">abcd, abce, abdx, abde</code> case, so we have <code class="language-plaintext highlighter-rouge">ab</code> four times here. Notice, that we can not choose <code class="language-plaintext highlighter-rouge">3, 2</code> and stop here, because in this case we will not count all occurences of <code class="language-plaintext highlighter-rouge">ab</code>. Also what matters is not four times but actually values from array <code class="language-plaintext highlighter-rouge">B</code>, that is their sum.</p>

<p>Finally, we have the following logic. In the beginning we have <code class="language-plaintext highlighter-rouge">n</code> separate segments with one element. Then we start with the biggest element in <code class="language-plaintext highlighter-rouge">LCP</code> and on each step for all elements with such value we merge groups. That is after first step we have groups:
<code class="language-plaintext highlighter-rouge">[1], [2], [3], [4, 5, 6], [7, 8], [9, 10]</code>. After next operation we have <code class="language-plaintext highlighter-rouge">[1], [2], [3, 4, 5, 6], [7, 8, 9, 10]</code> and so on. We need to keep:</p>
<ol>
  <li>Set of intervals, for this we will keep for each start end in dict <code class="language-plaintext highlighter-rouge">f1</code> and for each end start in <code class="language-plaintext highlighter-rouge">f2</code>. (see CF 1618F problem which use similar idea, it also can be done with union find).</li>
  <li>We also keep in sorted list tuples <code class="language-plaintext highlighter-rouge">(cost if interval, start, end)</code>. So, when we merget two intervals, we can quickly update it.</li>
</ol>

<p>Finally, important think is when we do this process we did not think about unique words. I do not know the elegant way to deal with them, so what we can do is to use our LCP array. For every place, corresponding to the start of the new string, we can evaluate <code class="language-plaintext highlighter-rouge">LCP[rank[i] - 1]</code> and <code class="language-plaintext highlighter-rouge">LCP[rank[i]]</code>. If both of these values not equal to the length of current string, it means that it is unique. Also it is enough to consider only full strings: if some part of string is unique, then all string is unique as well. We can have negative and positive costs, and if cost is negative it is always optimal to consider zero-length substring for this string.</p>

<h4 id="complexity-5">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(N log N)</code> for time and <code class="language-plaintext highlighter-rouge">O(N)</code> for space, where <code class="language-plaintext highlighter-rouge">N</code> is the total length of all strings.</p>

<h4 id="code-5">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="c1">### IMPORT SortedList and SuffixArray FROM TEMPLATES.
</span> 
<span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
<span class="n">arr</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">arr</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">input</span><span class="p">().</span><span class="n">rstrip</span><span class="p">()]</span>
 
<span class="n">CC</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="mi">96</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">B</span> <span class="o">+=</span> <span class="p">[</span><span class="n">CC</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">A</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">27</span><span class="p">]</span>
    <span class="n">B</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># it should not matter?
</span> 
 
<span class="n">sa</span> <span class="o">=</span> <span class="n">suffixArray</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">cnts</span> <span class="o">=</span> <span class="p">[</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sa</span><span class="p">]</span>
<span class="n">LCP</span><span class="p">,</span> <span class="n">rank</span> <span class="o">=</span> <span class="n">lcp</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">sa</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">f2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
 
<span class="n">d_lcp</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">LCP</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">d_lcp</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>
 
<span class="n">keys_lcp</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">d_lcp</span><span class="p">.</span><span class="n">keys</span><span class="p">())[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">27</span><span class="p">:</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">LCP</span><span class="p">[</span><span class="n">rank</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="n">LCP</span><span class="p">[</span><span class="n">rank</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">26</span>
        <span class="k">if</span> <span class="n">q1</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span> <span class="ow">and</span> <span class="n">q2</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">idx</span><span class="p">]):</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span> <span class="o">*</span> <span class="n">CC</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
 
<span class="n">costs</span> <span class="o">=</span> <span class="n">SortedList</span><span class="p">()</span>
 
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys_lcp</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">d_lcp</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">f1</span><span class="p">[</span><span class="n">u</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">u1</span> <span class="o">=</span> <span class="n">f2</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>
        <span class="n">cu</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">cnts</span><span class="p">[</span><span class="n">u1</span><span class="p">],</span> <span class="n">cnts</span><span class="p">[</span><span class="n">u</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">u1</span> <span class="o">!=</span> <span class="n">u</span><span class="p">:</span> <span class="n">costs</span><span class="p">.</span><span class="n">remove</span><span class="p">((</span><span class="n">cu</span><span class="p">,</span> <span class="n">u1</span><span class="p">,</span> <span class="n">u</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">u</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="n">v1</span><span class="p">:</span> <span class="n">costs</span><span class="p">.</span><span class="n">remove</span><span class="p">((</span><span class="n">cv</span><span class="p">,</span> <span class="n">u</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v1</span><span class="p">))</span>
        <span class="n">cnts</span><span class="p">[</span><span class="n">u1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cv</span>
        <span class="n">costs</span><span class="p">.</span><span class="n">add</span><span class="p">((</span><span class="n">cu</span> <span class="o">+</span> <span class="n">cv</span><span class="p">,</span> <span class="n">u1</span><span class="p">,</span> <span class="n">v1</span><span class="p">))</span>
        <span class="n">f1</span><span class="p">[</span><span class="n">u1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v1</span>
        <span class="n">f2</span><span class="p">[</span><span class="n">v1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u1</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">costs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">key</span><span class="p">)</span>
 
<span class="k">print</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
</code></pre></div></div>

  </div><a class="u-url" href="/codeforces/0616.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution and patterns for algorithmic questions: leetcode, binarysearch, codeforces, cses and probably more later.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body><script async src="https://www.googletagmanager.com/gtag/js?id=G-KR1GZKF62P"></script>
<script>
  window['ga-disable-G-KR1GZKF62P'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KR1GZKF62P');
</script>
</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>