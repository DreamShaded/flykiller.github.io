<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Leetcode 0850. Rectangle Area II | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Leetcode 0850. Rectangle Area II" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Problem statement" />
<meta property="og:description" content="Problem statement" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-10T21:58:09+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Leetcode 0850. Rectangle Area II" />
<script type="application/ld+json">
{"url":"/leetcode/0850.html","@type":"BlogPosting","headline":"Leetcode 0850. Rectangle Area II","dateModified":"2022-01-10T21:58:09+03:00","datePublished":"2022-01-10T21:58:09+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"/leetcode/0850.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Problem statement","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/leetcode%20problems/">Leetcode problems</a><a class="page-link" href="/coding%20ideas/">Patterns</a><a class="page-link" href="/performance%20tricks/">Speed up</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/segment tree"><code class="highligher-rouge"><nobr>segment tree</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/line sweep"><code class="highligher-rouge"><nobr>line sweep</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/geometry"><code class="highligher-rouge"><nobr>geometry</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Leetcode 0850. Rectangle Area II</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-01-10T21:58:09+03:00" itemprop="datePublished">
        Jan 10, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-statement">Problem statement</h4>

<p><a href="https://leetcode.com/problems/rectangle-area-ii/"> <font color="blue">https://leetcode.com/problems/rectangle-area-ii/</font></a></p>

<h4 id="solution-1">Solution 1</h4>
<p>One of the approaches is to do coordinates compression: for every <code class="language-plaintext highlighter-rouge">2n</code> <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> coordinates, there is in total will be <code class="language-plaintext highlighter-rouge">O(n^2)</code> possible candidates for part of figure. Then we can find for each of these candidates in <code class="language-plaintext highlighter-rouge">O(n)</code> if it is part of figure or not.</p>

<h4 id="complexity">Complexity</h4>
<p>Time complexity will be <code class="language-plaintext highlighter-rouge">O(n^3)</code>, space is <code class="language-plaintext highlighter-rouge">O(n^2)</code> or can be done in <code class="language-plaintext highlighter-rouge">O(n)</code> as well.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">rectangleArea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rectangles</span><span class="p">):</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangles</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">]]))</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">y</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangles</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">]]))</span>
        <span class="n">x_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xs</span><span class="p">)}</span>
        <span class="n">y_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ys</span><span class="p">)}</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_i</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_i</span><span class="p">)</span>
        
        <span class="n">grid</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangles</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x_i</span><span class="p">[</span><span class="n">x1</span><span class="p">],</span> <span class="n">x_i</span><span class="p">[</span><span class="n">x2</span><span class="p">]):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_i</span><span class="p">[</span><span class="n">y1</span><span class="p">],</span> <span class="n">y_i</span><span class="p">[</span><span class="n">y2</span><span class="p">]):</span>
                    <span class="n">grid</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">ans</span> <span class="o">+=</span> <span class="n">grid</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ys</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ans</span>  <span class="o">%</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="solution-2">Solution 2</h4>
<p>There is another solution, using line sweep. Let us sort our rectangles by <code class="language-plaintext highlighter-rouge">x</code> coordinate and move vertical line from left to right. Then we can use problem <strong>56. Merge Intervals</strong>: we need to keep active set of sides and then remove them or add to it. Also we can use neat trick to handle sides from different rectangles which have the same <code class="language-plaintext highlighter-rouge">x</code> coordinate, using value <code class="language-plaintext highlighter-rouge">prev_x</code>.</p>

<h4 id="complexity-1">Complexity</h4>
<p>Time complexity will be <code class="language-plaintext highlighter-rouge">O(n^2 log n)</code>, space complexity is <code class="language-plaintext highlighter-rouge">O(n)</code>.</p>

<h4 id="code-1">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">rectangleArea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rectangles</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">intervals</span><span class="p">):</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">beg</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">intervals</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">ans</span> <span class="ow">or</span> <span class="n">ans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">beg</span><span class="p">:</span>
                    <span class="n">ans</span> <span class="o">+=</span> <span class="p">[[</span><span class="n">beg</span><span class="p">,</span> <span class="n">end</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">end</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">ans</span><span class="p">)</span>
        
        <span class="n">sides_lft</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangles</span><span class="p">]</span>
        <span class="n">sides_rgh</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangles</span><span class="p">]</span>
        <span class="n">sides</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sides_lft</span> <span class="o">+</span> <span class="n">sides_rgh</span><span class="p">)</span>
        
        <span class="n">intervals</span><span class="p">,</span> <span class="n">ans</span><span class="p">,</span> <span class="n">prev_x</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sides</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">op_cl</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">sides</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="n">merge</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">prev_x</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">op_cl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">intervals</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">intervals</span><span class="p">.</span><span class="n">remove</span><span class="p">((</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">))</span>     
            <span class="n">prev_x</span> <span class="o">=</span> <span class="n">x</span>
            
        <span class="k">return</span> <span class="n">ans</span> <span class="o">%</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="solution-3">Solution 3</h4>
<p>Actually, we can do our interval merge in <code class="language-plaintext highlighter-rouge">O(n)</code> time instead of <code class="language-plaintext highlighter-rouge">O(n^2)</code>. First, let us create all unique <code class="language-plaintext highlighter-rouge">y</code> coordinates: set <code class="language-plaintext highlighter-rouge">ys</code>, then we create correspondences between indexes and these <code class="language-plaintext highlighter-rouge">y</code> coordinates: this is <code class="language-plaintext highlighter-rouge">y_i</code> dictionary. Finally, <code class="language-plaintext highlighter-rouge">count</code> will be count: how many times each segment is covered. We again create sides like in previous approach.</p>

<p>Next, we again iterate through our sides and update area, but now when we meet new segment, we update <code class="language-plaintext highlighter-rouge">count</code>} for range: <code class="language-plaintext highlighter-rouge">+1</code> for start of rectangle and <code class="language-plaintext highlighter-rouge">-1</code> for end of rectangle. Finally, we update our <code class="language-plaintext highlighter-rouge">cur_y_sum</code>: we check if count is <code class="language-plaintext highlighter-rouge">0</code> and if it is more than <code class="language-plaintext highlighter-rouge">0</code>, we add length of this segment to <code class="language-plaintext highlighter-rouge">cur_y_sum</code>.</p>

<h4 id="complexity-2">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n^2)</code> for time and <code class="language-plaintext highlighter-rouge">O(n)</code> for space.</p>

<h4 id="code-2">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">rectangleArea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rectangles</span><span class="p">):</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">y</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangles</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">]]))</span>
        <span class="n">y_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ys</span><span class="p">)}</span>
        <span class="n">count</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_i</span><span class="p">)</span>
        
        <span class="n">sides_lft</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangles</span><span class="p">]</span>
        <span class="n">sides_rgh</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangles</span><span class="p">]</span>
        <span class="n">sides</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sides_lft</span> <span class="o">+</span> <span class="n">sides_rgh</span><span class="p">)</span>
         
        <span class="n">cur_x</span> <span class="o">=</span> <span class="n">cur_y_sum</span> <span class="o">=</span> <span class="n">area</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">op_cl</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">sides</span><span class="p">:</span>
            <span class="n">area</span> <span class="o">+=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">cur_x</span><span class="p">)</span> <span class="o">*</span> <span class="n">cur_y_sum</span>
            <span class="n">cur_x</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_i</span><span class="p">[</span><span class="n">y1</span><span class="p">],</span> <span class="n">y_i</span><span class="p">[</span><span class="n">y2</span><span class="p">]):</span>
                <span class="n">count</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">op_cl</span>
            <span class="n">cur_y_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span> <span class="k">if</span> <span class="n">c</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">ys</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">count</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">area</span> <span class="o">%</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="solution-4">Solution 4</h4>
<p>There is also <code class="language-plaintext highlighter-rouge">O(n log n)</code> solution, using segment trees. The idea is to use segment tree where we need to deal only with updates of ranges. If we need only range updats, and not queries, not need to do lazy updates - see https://cp-algorithms.com/data_structures/segment_tree.html, (<strong>Addition on segments</strong>) chapter. Also we need to need to keep <code class="language-plaintext highlighter-rouge">self.total</code> dictionary, which for each segment will calculate lenght of all active segments we have so far.</p>

<h4 id="complexity-3">Complexity</h4>
<p>It is just <code class="language-plaintext highlighter-rouge">O(n log n)</code>.</p>

<h4 id="code-3">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">SegmentTree</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">cnts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">total</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">xs</span> <span class="o">=</span> <span class="n">xs</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">tl</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="n">tr</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">cnts</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+=</span> <span class="n">h</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tm</span> <span class="o">=</span> <span class="p">(</span><span class="n">tl</span> <span class="o">+</span> <span class="n">tr</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tm</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">tm</span><span class="p">),</span> <span class="n">h</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">tm</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">tm</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
          
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">cnts</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">total</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xs</span><span class="p">[</span><span class="n">tr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">xs</span><span class="p">[</span><span class="n">tl</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">total</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">total</span><span class="p">[</span><span class="n">v</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">total</span><span class="p">[</span><span class="n">v</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">total</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
    
<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">rectangleArea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rectangles</span><span class="p">):</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangles</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">]]))</span>
        <span class="n">xs_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xs</span><span class="p">)}</span>

        <span class="n">STree</span> <span class="o">=</span> <span class="n">SegmentTree</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
        <span class="n">L</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">rectangles</span><span class="p">:</span>
            <span class="n">L</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">y1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>
            <span class="n">L</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">y2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>
        <span class="n">L</span><span class="p">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">cur_y</span> <span class="o">=</span> <span class="n">cur_x_sum</span> <span class="o">=</span> <span class="n">area</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">op_cl</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
            <span class="n">area</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">cur_y</span><span class="p">)</span> <span class="o">*</span> <span class="n">cur_x_sum</span>
            <span class="n">cur_y</span> <span class="o">=</span> <span class="n">y</span>
            <span class="n">STree</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xs_i</span><span class="p">[</span><span class="n">x1</span><span class="p">],</span> <span class="n">xs_i</span><span class="p">[</span><span class="n">x2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">op_cl</span><span class="p">)</span>
            <span class="n">cur_x_sum</span> <span class="o">=</span> <span class="n">STree</span><span class="p">.</span><span class="n">total</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            
        <span class="k">return</span> <span class="n">area</span> <span class="o">%</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>
</code></pre></div></div>

  </div><a class="u-url" href="/leetcode/0850.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>