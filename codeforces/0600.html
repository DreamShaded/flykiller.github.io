<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Codeforces contest 0600 | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Codeforces contest 0600" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems." />
<meta property="og:description" content="Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems." />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Codeforces contest 0600" />
<script type="application/ld+json">
{"url":"/codeforces/0600.html","@type":"WebPage","headline":"Codeforces contest 0600","author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/leetcode%20problems/">Leetcode</a><a class="page-link" href="/codeforces%20problems/">Codeforces</a><a class="page-link" href="/binarysearch%20problems/">BinarySearch</a><a class="page-link" href="/coding%20ideas/">Patterns</a><a class="page-link" href="/performance%20tricks/">Speed up</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/string"><code class="highligher-rouge"><nobr>string</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/parser"><code class="highligher-rouge"><nobr>parser</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/graph"><code class="highligher-rouge"><nobr>graph</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/tree"><code class="highligher-rouge"><nobr>tree</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/binary search"><code class="highligher-rouge"><nobr>binary search</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/two pointers"><code class="highligher-rouge"><nobr>two pointers</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/counter"><code class="highligher-rouge"><nobr>counter</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/palindrome"><code class="highligher-rouge"><nobr>palindrome</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/geometry"><code class="highligher-rouge"><nobr>geometry</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/math"><code class="highligher-rouge"><nobr>math</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/graph algo"><code class="highligher-rouge"><nobr>graph algo</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/greedy"><code class="highligher-rouge"><nobr>greedy</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Codeforces contest 0600</h1>
    <p class="post-meta"><time class="dt-published" datetime="" itemprop="datePublished">
        
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-a-statement">Problem A statement</h4>
<p>[string, parser]</p>

<p><a href="https://codeforces.com/contest/600/problem/A"> <font color="blue">https://codeforces.com/contest/600/problem/A</font></a></p>

<h4 id="solution">Solution</h4>
<p>Just use python functionality to split string and then check if each part is integer.</p>

<h4 id="complexity">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n)</code> for time and space.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span> <span class="o">=</span> <span class="nb">input</span><span class="p">().</span><span class="n">rstrip</span><span class="p">()</span>
 
<span class="n">parts</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">";"</span><span class="p">,</span> <span class="s">","</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="s">","</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">part</span><span class="p">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">part</span><span class="p">))</span> <span class="o">==</span> <span class="n">part</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="p">[</span><span class="n">part</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">+=</span> <span class="p">[</span><span class="n">part</span><span class="p">]</span>
 
<span class="k">print</span><span class="p">(</span><span class="s">","</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span> <span class="k">else</span> <span class="s">"-"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">","</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">if</span> <span class="n">b</span> <span class="k">else</span> <span class="s">"-"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="problem-b-statement">Problem B statement</h4>
<p>[binary search, two pointers]</p>

<p><a href="https://codeforces.com/contest/600/problem/B"> <font color="blue">https://codeforces.com/contest/600/problem/B</font></a></p>

<h4 id="solution-1">Solution</h4>
<p>First, sort array <code class="language-plaintext highlighter-rouge">A</code>, then for each element of element <code class="language-plaintext highlighter-rouge">B</code> use binary search. Another way is to use two pointers where we sort <code class="language-plaintext highlighter-rouge">B</code> as well.</p>

<h4 id="complexity-1">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n log n + m log n)</code> for time and <code class="language-plaintext highlighter-rouge">O(n + m)</code> for space.</p>

<h4 id="code-1">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">bisect</span> <span class="kn">import</span> <span class="n">bisect</span>
<span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>

<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">I</span><span class="p">())</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="n">bisect</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s">" "</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">ans</span><span class="p">))</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="problem-c-statement">Problem C statement</h4>
<p>[counter, string, palindrome]</p>

<p><a href="https://codeforces.com/contest/600/problem/C"> <font color="blue">https://codeforces.com/contest/600/problem/C</font></a></p>

<h4 id="solution-2">Solution</h4>
<p>First, we need to found all letters with odd frequency.</p>
<ol>
  <li>If we have 0 of them, then we need to make <code class="language-plaintext highlighter-rouge">0</code> changes.</li>
  <li>If we have 1 of them, we need to make <code class="language-plaintext highlighter-rouge">0</code> changes.</li>
  <li>If we have 2 of them, say <code class="language-plaintext highlighter-rouge">a</code> and <code class="language-plaintext highlighter-rouge">b</code>, we need to make <code class="language-plaintext highlighter-rouge">1</code> changes to make it <code class="language-plaintext highlighter-rouge">aa</code>.</li>
  <li>If we have 3 of them, say <code class="language-plaintext highlighter-rouge">a</code>, <code class="language-plaintext highlighter-rouge">b</code> and <code class="language-plaintext highlighter-rouge">c</code>, we need to make <code class="language-plaintext highlighter-rouge">1</code> changes to make it <code class="language-plaintext highlighter-rouge">aba</code>.</li>
  <li>If we have 4 of them, say <code class="language-plaintext highlighter-rouge">a</code>, <code class="language-plaintext highlighter-rouge">b</code>, <code class="language-plaintext highlighter-rouge">c</code>, <code class="language-plaintext highlighter-rouge">d</code>, we need to make <code class="language-plaintext highlighter-rouge">2 changes to make it </code>abba<code class="language-plaintext highlighter-rouge">.
Also if we have say </code>5<code class="language-plaintext highlighter-rouge"> elements of </code>a<code class="language-plaintext highlighter-rouge">, we put </code>aa` to even part. In the end we sort even part and deal with middle element.</li>
</ol>

<h4 id="complexity-2">Complexity</h4>
<p>Time complexity is <code class="language-plaintext highlighter-rouge">O(n log n)</code>, space complexity is <code class="language-plaintext highlighter-rouge">O(n)</code>.</p>

<h4 id="code-2">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
 
<span class="n">s</span> <span class="o">=</span> <span class="nb">input</span><span class="p">().</span><span class="n">rstrip</span><span class="p">()</span>
<span class="n">cnt</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">odd</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">even</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cnt</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">cnt</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">odd</span> <span class="o">+=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
    <span class="n">even</span> <span class="o">+=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
 
<span class="n">odd</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">odd</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="s">""</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">odd</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">odd</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">odd</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">odd</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">odd</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]:</span>
    <span class="n">even</span> <span class="o">+=</span> <span class="n">x</span>
 
<span class="n">half</span> <span class="o">=</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">even</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">half</span> <span class="o">+</span> <span class="n">mid</span> <span class="o">+</span> <span class="n">half</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<h4 id="problem-d-statement">Problem D statement</h4>
<p>[geometry, math]</p>

<p><a href="https://codeforces.com/contest/600/problem/D"> <font color="blue">https://codeforces.com/contest/600/problem/D</font></a></p>

<h4 id="solution-3">Solution</h4>
<p>All we need to do is bunch of formulae. However in python precision is not enough and one way to handle it is to use libarary <code class="language-plaintext highlighter-rouge">Decimal</code> to make better precision.</p>

<h4 id="complexity-3">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(1)</code> if other languates, in python it depends on approximation</p>

<h4 id="code-3">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">acos</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">getcontext</span><span class="p">().</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">2e-7</span>

<span class="k">def</span> <span class="nf">_acos</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">eps</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">acos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pi</span> <span class="o">-</span> <span class="n">_acos</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">6</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">40</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">112</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">).</span><span class="n">sqrt</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span>
                <span class="mi">1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">12</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">160</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">896</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">35</span> <span class="o">/</span> <span class="mi">18432</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">63</span> <span class="o">/</span> <span class="mi">90112</span><span class="p">)</span>

<span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">)).</span><span class="n">sqrt</span><span class="p">()</span>

<span class="k">if</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">r2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">r1</span> <span class="o">*</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
<span class="k">elif</span> <span class="n">r2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">r1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">r2</span> <span class="o">*</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="n">r2</span> <span class="o">*</span> <span class="n">r2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">r1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">r2</span><span class="p">)</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">r1</span> <span class="o">*</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">r2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">r1</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">r2</span> <span class="o">*</span> <span class="n">r2</span> <span class="o">*</span> <span class="p">(</span><span class="n">_acos</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span> <span class="o">-</span> <span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c1</span><span class="o">*</span><span class="n">c1</span><span class="p">).</span><span class="n">sqrt</span><span class="p">())</span> <span class="o">+</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">r1</span> <span class="o">*</span> <span class="p">(</span><span class="n">_acos</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span> <span class="o">-</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c2</span><span class="o">*</span><span class="n">c2</span><span class="p">).</span><span class="n">sqrt</span><span class="p">()))</span>

</code></pre></div></div>

<h4 id="problem-e-statement">Problem E statement</h4>
<p>[graph, tree]</p>

<p><a href="https://codeforces.com/contest/600/problem/E"> <font color="blue">https://codeforces.com/contest/600/problem/E</font></a></p>

<h4 id="solution-4">Solution</h4>
<p>See Binarysearch 0507 problem, it uses the similar idea. We need to travese our tree with dfs and keep some data in each node about its subtree. When we merge two nodes, we always do it <strong>small to larger</strong>. What we keep in each node:</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">c_t</code> is Counter for each color.</li>
  <li><code class="language-plaintext highlighter-rouge">t_c</code> is defaultdict, where for each frequency we keep set of nodes.</li>
  <li><code class="language-plaintext highlighter-rouge">ans</code> is answer for this node, that is sum of all colors with the highest frequency.</li>
  <li><code class="language-plaintext highlighter-rouge">mx</code> is the maximum frequency.</li>
</ol>

<p>Then we add new color to our structure, we can do it just in <code class="language-plaintext highlighter-rouge">O(1)</code> time! We check how may nodes with color <code class="language-plaintext highlighter-rouge">c</code> we already have and update <code class="language-plaintext highlighter-rouge">c_t</code> and <code class="language-plaintext highlighter-rouge">t_c</code>. Also if new frequency is bigger than current one, we set <code class="language-plaintext highlighter-rouge">ans = c</code>. If it is the same, we update <code class="language-plaintext highlighter-rouge">ans += c</code>.</p>

<p>Also we need to use booster for dfs to get AC.</p>

<h4 id="complexity-4">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n log n)</code> for time and <code class="language-plaintext highlighter-rouge">O(n)</code> for space.</p>

<h4 id="code-4">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">Counter</span>
<span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>
<span class="kn">import</span> <span class="nn">io</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">sys</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">os</span><span class="p">.</span><span class="n">fstat</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">st_size</span><span class="p">)).</span><span class="n">readline</span>

<span class="c1">#### IMPORT BOOTSTRAP FOR RECURSION FROM TEMPLATES
</span>
<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">ans</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">mx</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">c_t</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">c</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">t_c</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">t_c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">other</span><span class="p">.</span><span class="n">c_t</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">old_t</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">c_t</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">c_t</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_t</span> <span class="o">=</span> <span class="n">old_t</span> <span class="o">+</span> <span class="n">t</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">t_c</span><span class="p">[</span><span class="n">old_t</span><span class="p">].</span><span class="n">discard</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">t_c</span><span class="p">[</span><span class="n">new_t</span><span class="p">].</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_t</span> <span class="o">==</span> <span class="bp">self</span><span class="p">.</span><span class="n">mx</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">ans</span> <span class="o">+=</span> <span class="n">c</span>
        <span class="k">elif</span> <span class="n">new_t</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">mx</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">mx</span> <span class="o">=</span> <span class="n">new_t</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">ans</span> <span class="o">=</span> <span class="n">c</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">c_t</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">ans</span><span class="p">)</span>

<span class="o">@</span><span class="n">bootstrap</span>
<span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <span class="n">ans_n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">child</span> <span class="o">==</span> <span class="n">par</span><span class="p">:</span> <span class="k">continue</span>
        <span class="n">ans_c</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">dfs</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">child</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ans_n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ans_c</span><span class="p">):</span>
            <span class="n">ans_n</span><span class="p">,</span> <span class="n">ans_c</span> <span class="o">=</span> <span class="n">ans_c</span><span class="p">,</span> <span class="n">ans_n</span>
        <span class="n">ans_n</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ans_c</span><span class="p">)</span>
    <span class="n">out</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">ans_n</span><span class="p">.</span><span class="n">ans</span>
    <span class="k">yield</span> <span class="n">ans_n</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
<span class="n">color</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
    <span class="n">G</span><span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">G</span><span class="p">[</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">dfs</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">" "</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">out</span><span class="p">))</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

</code></pre></div></div>
<h4 id="remark">Remark</h4>
<p>Notice, that what we can keep instead of <code class="language-plaintext highlighter-rouge">t_c</code> is sorted list of pairs (frequency, color), but then we will have <code class="language-plaintext highlighter-rouge">O(n log^2)</code> complexity, which is too big for python.</p>

<h4 id="problem-f-statement">Problem F statement</h4>
<p>[graph, graph algo, dfs, greedy]</p>

<p><a href="https://codeforces.com/contest/600/problem/F"> <font color="blue">https://codeforces.com/contest/600/problem/F</font></a></p>

<h4 id="solution-5">Solution</h4>
<p>What is asked in this problem is called chromatic number of graph. It can be proven that chromatic number of bipartite graph is equal to the biggest degree. However we also need to construct coloring as well. There are different time complexities algorithms and problem constraints allow ust to use quite simple one. The idea is to try to color edges if we can. If we not able to color some edge, it means that for current edge <code class="language-plaintext highlighter-rouge">ab</code> we have colors <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code>, such that we have <code class="language-plaintext highlighter-rouge">x</code> in <code class="language-plaintext highlighter-rouge">a</code> but not in <code class="language-plaintext highlighter-rouge">b</code> and we have <code class="language-plaintext highlighter-rouge">y</code> in <code class="language-plaintext highlighter-rouge">b</code> but not in <code class="language-plaintext highlighter-rouge">a</code>. If <code class="language-plaintext highlighter-rouge">x == y</code>, it means that we can draw edge without conflicts. If <code class="language-plaintext highlighter-rouge">x != y</code>, it means that we have conflicts and we need to recolor some edges. Because of bipartite property we always can do it no more than in <code class="language-plaintext highlighter-rouge">O(n)</code> steps: we will look for the chain where colors of edges are change: <code class="language-plaintext highlighter-rouge">x, y, x, y, ... </code> and we never have conflicts and in one moment nodes will end.</p>

<h4 id="complexity-5">Complexity</h4>
<p>Time complexity is <code class="language-plaintext highlighter-rouge">O(mn)</code>, space is <code class="language-plaintext highlighter-rouge">O(n^2)</code>.</p>

<h4 id="code-5">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">io</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">sys</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="n">fstat</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">st_size</span><span class="p">)).</span><span class="n">readline</span>
 
<span class="n">I</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">()]</span>
 
<span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">:</span> <span class="k">return</span>
    <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">z</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
    <span class="n">dfs</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">z</span><span class="p">],</span> <span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
 
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">I</span><span class="p">()</span>
    <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">a</span>
    <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
 
<span class="n">s</span><span class="p">,</span> <span class="n">ans</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="p">[]</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">s</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]].</span><span class="n">index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]].</span><span class="n">index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span> <span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="k">break</span>
 
<span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="o">+</span> <span class="s">" "</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">ans</span><span class="p">))</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="remark-1">Remark</h4>
<p>There are better time complexity algorithm, see wikipedia for names.</p>

  </div><a class="u-url" href="/codeforces/0600.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>