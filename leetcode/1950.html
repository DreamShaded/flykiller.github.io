<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Leetcode 1950 Maximum of Minimum Values in All Subarrays | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Leetcode 1950 Maximum of Minimum Values in All Subarrays" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Problem statement" />
<meta property="og:description" content="Problem statement" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-28T14:01:08+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Leetcode 1950 Maximum of Minimum Values in All Subarrays" />
<script type="application/ld+json">
{"url":"/leetcode/1950.html","@type":"BlogPosting","headline":"Leetcode 1950 Maximum of Minimum Values in All Subarrays","dateModified":"2022-01-28T14:01:08+03:00","datePublished":"2022-01-28T14:01:08+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"/leetcode/1950.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Problem statement","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/leetcode%20problems/">Leetcode</a><a class="page-link" href="/codeforces%20problems/">Codeforces</a><a class="page-link" href="/binarysearch%20problems/">BinarySearch</a><a class="page-link" href="/coding%20ideas/">Patterns</a><a class="page-link" href="/performance%20tricks/">Speed up</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/monotinic deque"><code class="highligher-rouge"><nobr>monotinic deque</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/union find"><code class="highligher-rouge"><nobr>union find</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/bst"><code class="highligher-rouge"><nobr>bst</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/intervals"><code class="highligher-rouge"><nobr>intervals</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Leetcode 1950 Maximum of Minimum Values in All Subarrays</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-01-28T14:01:08+03:00" itemprop="datePublished">
        Jan 28, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-statement">Problem statement</h4>

<p><a href="https://leetcode.com/problems/maximum-of-minimum-values-in-all-subarrays/"> <font color="blue">https://leetcode.com/problems/maximum-of-minimum-values-in-all-subarrays/</font></a></p>

<h4 id="solution-1">Solution 1</h4>
<p>It is quite difficult problem in fact, it should be marked as hard and even among hards it is not the easiest one. One of the ways to solve this problem is to use <code class="language-plaintext highlighter-rouge">dsu</code>. Imagine that we have numbers <code class="language-plaintext highlighter-rouge">arr = [1, 4, 2, 8, 5, 7]</code>. Let us start from big numbers and add number by number, we have</p>

<p><code class="language-plaintext highlighter-rouge">_ _ _ _ _ _</code></p>

<p><code class="language-plaintext highlighter-rouge">_ _ _ 8 _ _</code></p>

<p><code class="language-plaintext highlighter-rouge">_ _ _ 8 _ 7</code></p>

<p><code class="language-plaintext highlighter-rouge">_ _ _ 8 5 7</code></p>

<p><code class="language-plaintext highlighter-rouge">_ 4 _ 8 5 7</code></p>

<p><code class="language-plaintext highlighter-rouge">_ 4 2 8 5 7</code></p>

<p><code class="language-plaintext highlighter-rouge">1 4 2 8 4 7</code></p>

<p>What we ask each time we add new number: what is the biggest size of group we have: for example when we have <code class="language-plaintext highlighter-rouge">_ _ _ 8 5 7</code> we have group of size <code class="language-plaintext highlighter-rouge">3</code> and it means that there is window of size <code class="language-plaintext highlighter-rouge">3</code> with minimum value <code class="language-plaintext highlighter-rouge">&gt;= 5</code>. If we look at the biggest groups, we will have <code class="language-plaintext highlighter-rouge">1, 1, 3, 3, 5, 6</code>. It means, that we have answer <code class="language-plaintext highlighter-rouge">[8, 5, 5, 2, 2, 1]</code>: first element is always the biggest element in array. Then after we add <code class="language-plaintext highlighter-rouge">7</code> biggest length do not changed, so do nothing. Then we add <code class="language-plaintext highlighter-rouge">5</code> and now length is equal to <code class="language-plaintext highlighter-rouge">3</code>, so we add <code class="language-plaintext highlighter-rouge">5</code>, <code class="language-plaintext highlighter-rouge">5</code>: until we have <code class="language-plaintext highlighter-rouge">3</code> elements in <code class="language-plaintext highlighter-rouge">res</code>. Then we add <code class="language-plaintext highlighter-rouge">4</code>: nothing changes. Then we add <code class="language-plaintext highlighter-rouge">2</code>, now we have group of size <code class="language-plaintext highlighter-rouge">5</code>: so we add <code class="language-plaintext highlighter-rouge">2</code> two times. Finally we add <code class="language-plaintext highlighter-rouge">1</code> and we have group of size <code class="language-plaintext highlighter-rouge">6</code>.</p>

<p>Note, that it is very useful to keep dsu data structure to be able quickly update our segments.</p>

<h4 id="complexity">Complexity</h4>
<p>It is <code class="language-plaintext highlighter-rouge">O(n log n)</code>, because we sorted our data and then use <code class="language-plaintext highlighter-rouge">dsu</code> with path compression which is <code class="language-plaintext highlighter-rouge">O(log n)</code> applied <code class="language-plaintext highlighter-rouge">n</code> times. Space complexity is <code class="language-plaintext highlighter-rouge">O(n)</code>.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">DSU</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">p</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="p">{}</span>
        
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">size</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">yr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">p</span><span class="p">[</span><span class="n">xr</span><span class="p">]</span> <span class="o">=</span> <span class="n">yr</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">size</span><span class="p">[</span><span class="n">yr</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">size</span><span class="p">[</span><span class="n">xr</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">findMaximums</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="n">dsu</span> <span class="o">=</span> <span class="n">DSU</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">arr</span><span class="p">[</span><span class="n">x</span><span class="p">]):</span>
            <span class="n">dsu</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">dsu</span><span class="p">.</span><span class="n">p</span><span class="p">:</span> <span class="n">dsu</span><span class="p">.</span><span class="n">union</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">dsu</span><span class="p">.</span><span class="n">p</span><span class="p">:</span> <span class="n">dsu</span><span class="p">.</span><span class="n">union</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">dsu</span><span class="p">.</span><span class="n">size</span><span class="p">[</span><span class="n">dsu</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">+=</span> <span class="p">[</span><span class="n">arr</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>

        <span class="k">return</span> <span class="n">res</span>
</code></pre></div></div>

<h4 id="solution-2">Solution 2</h4>

<p>In fact, we can use problem <strong>0352</strong>. Data Stream as Disjoint Intervals: this is exactly what we want do have and we need to keep length of the biggest interval.</p>

<h4 id="complexity-1">Complexity</h4>
<p>Time complexity is <code class="language-plaintext highlighter-rouge">O(n log n)</code>, because we sort and space complexity is <code class="language-plaintext highlighter-rouge">O(n)</code>.</p>

<h4 id="code-1">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">SummaryRanges</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">d1</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">d2</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">max_len</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">addNum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">i1</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">d2</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">i2</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">d1</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lft</span><span class="p">,</span> <span class="n">rgh</span> <span class="o">=</span> <span class="n">v</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">d2</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">d1</span>
                
        <span class="k">if</span> <span class="n">lft</span> <span class="ow">and</span> <span class="n">rgh</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">d1</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="n">i2</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">d2</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="n">i1</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">max_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">max_len</span><span class="p">,</span> <span class="n">i2</span><span class="o">-</span><span class="n">i1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">lft</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">rgh</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">d1</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">d2</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">i1</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">max_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">max_len</span><span class="p">,</span> <span class="n">v</span><span class="o">-</span><span class="n">i1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">lft</span> <span class="ow">and</span> <span class="n">rgh</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">d2</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">d1</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">i2</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">max_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">max_len</span><span class="p">,</span> <span class="n">i2</span><span class="o">-</span><span class="n">v</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">d1</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">d2</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">max_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">max_len</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="p">.</span><span class="n">d2</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">d1</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getIntervals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">([[</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">d1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">d1</span><span class="p">])</span>
        

<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">findMaximums</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="n">ranges</span> <span class="o">=</span> <span class="n">SummaryRanges</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">arr</span><span class="p">[</span><span class="n">x</span><span class="p">]):</span>
            <span class="n">ranges</span><span class="p">.</span><span class="n">addNum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ranges</span><span class="p">.</span><span class="n">max_len</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">+=</span> <span class="p">[</span><span class="n">arr</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>

        <span class="k">return</span> <span class="n">res</span>
</code></pre></div></div>

<h4 id="solution-3">Solution 3</h4>

<p>Finally, there is solution, using monotonic stack. The idea is: <code class="language-plaintext highlighter-rouge">for each coming element nums[i], calculate L and R, the indices of the first smallest elements on the left and the right respectively</code>. Then <code class="language-plaintext highlighter-rouge">the answer of the queries from 1 to R-L+1 will be at least this element</code>. It means that we can find for each value the biggest window we can have and then use accumulate maximum from the end to get answer.</p>

<h4 id="complexity-2">Complexity</h4>
<p>Time complexity is <code class="language-plaintext highlighter-rouge">O(n)</code>, space is <code class="language-plaintext highlighter-rouge">O(n)</code>.</p>

<h4 id="code-2">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">findMaximums</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
        <span class="n">lft</span><span class="p">,</span> <span class="n">rgh</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
       
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">while</span> <span class="n">stack</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">nums</span><span class="p">[</span><span class="n">stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]:</span> <span class="n">stack</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">stack</span><span class="p">:</span> <span class="n">lft</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">stack</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">while</span> <span class="n">stack</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">nums</span><span class="p">[</span><span class="n">stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]:</span> <span class="n">stack</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">stack</span><span class="p">:</span> <span class="n">rgh</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">stack</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">ln</span> <span class="o">=</span> <span class="n">rgh</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">lft</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span>
            <span class="n">res</span><span class="p">[</span><span class="n">ln</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">ln</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">accumulate</span><span class="p">(</span><span class="n">res</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">max</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="remark">Remark</h4>
<p>I have one more idea how to solve this problem: we can start from the smallest numbers (like we did in solutions 1 and 2, but in opposite order) and now we need to keep the length of the biggest non-covered interval. We can put indexes in BST (SortedList) and then each time we put new, update lengths. I think complexity will be <code class="language-plaintext highlighter-rouge">O(n log n)</code> as well.</p>


  </div><a class="u-url" href="/leetcode/1950.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>